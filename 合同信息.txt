select  
DATE_FORMAT(a.create_time,'%Y-%m') 月份,
 f.name 公司,
e.name  合同校区,
a.ID 合同编号,
c.id 合同产品编号,
a.create_time 签约日期,
(select  g.name from data_dict g where g.id=a.grade_id) 合同年级,
b.name  学生,
(select  q.name  from data_dict q  where q.id=b.grade_id)  属性年级（学生列表年级） ,-- 学生对应年级
(select  q.name  from data_dict q  where q.id=c.type )  签约产品类型,
d.name 签约产品名称,
(select  q.name  from data_dict q  where q.id=d.grade_id)   签约产品年级,
case when a.contract_type='INIT_CONTRACT' then '初始合同'  
    when a.contract_type='NEW_CONTRACT' then '新签合同'  
    when a.contract_type='RE_CONTRACT' then '续签合同'  
    else '未知'  end as  合同类型,
(select z.name  from user z  where z.user_id=a.create_user_id)  签单人,
case when c.paid_status='PAID' then '付款完成'  
     when c.paid_status='CANCELED' then '已取消'  
     when c.paid_status='PAYING' then '付款中'  
     when c.paid_status='UNPAY' then '未付款'  
     else '未知'  end as 产品付款状态,
case when c.status='NORMAL'  then '正常'
      when c.status='ENDED'  then '结束'
     when c.status='CLOSE_PRODUCT'  then '结课'
 when c.status='UNVALID'  then '无效' 
else '未知'  end as  产品状态,
case when a.paid_status='PAID' then '付款完成'  
     when a.paid_status='CANCELED' then '已取消'  
     when a.paid_status='PAYING' then '付款中'  
     when a.paid_status='UNPAY' then '未付款'  
     else '未知'  end as  合同付款状态,
c.plan_AMOUNT 产品金额,	
c.real_amount  产品应收金额,	
c.promotion_amount 产品优惠金额,
a.remark  备注
from contract  a
left join student b on a.student_id=b.id
left join contract_product  c on c.contract_id=a.ID
left join product d on d.id=c.product_id
left join organization  e on e.id=a.BL_CAMPUS_ID
left join organization  f on f.id=e.parentid
where 
DATE_FORMAT(a.create_time,'%Y-%m')='2019-06'
ORDER BY f.name,e.name,a.create_time